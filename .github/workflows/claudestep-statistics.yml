name: ClaudeStep Daily Statistics

# This is an example workflow showing how to use ClaudeStep Statistics with Slack
# It demonstrates:
# 1. Generating statistics using the statistics-action
# 2. Automatic Slack notifications via action input
# 3. Scheduling for daily reports

on:
  schedule:
    - cron: '0 9 * * *'  # Daily at 9 AM UTC
  workflow_dispatch:  # Allow manual trigger for testing
    inputs:
      base_branch:
        description: 'Base branch where spec files are located'
        required: false
        default: 'main'

permissions:
  contents: read
  actions: read

jobs:
  statistics:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Generate ClaudeStep Statistics
        id: stats
        uses: ./statistics  # Use local action (for this repo)
        # For external repos, use: gestrich/claude-step/statistics@v1
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          base_branch: ${{ github.event.inputs.base_branch || 'main' }}
          days_back: 7  # Last 7 days of activity
          slack_webhook_url: ${{ secrets.SLACK_WEBHOOK_URL }}

      # Example: Per-project statistics
      # Uncomment to generate stats for a specific project only
      #
      # - name: Generate Project-Specific Statistics
      #   id: project_stats
      #   uses: ./statistics
      #   with:
      #     github_token: ${{ secrets.GITHUB_TOKEN }}
      #     config_path: refactor/my-project/configuration.json
      #     days_back: 30
      #     slack_webhook_url: ${{ secrets.MY_PROJECT_SLACK_WEBHOOK }}
